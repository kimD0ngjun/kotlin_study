package intermediate.lambda

// https://kotlinlang.org/docs/kotlin-tour-intermediate-lambdas-receiver.html

/**
 * μλ°”μ—μ„ λλ‹¤λ¥Ό ν‘ν„ν•λ () -> {} μ΄κ±΄ μ‚¬μ‹¤ μλ°”μ λ¬Έλ²•μ  μ„¤νƒ•μ΄λ‹¤
 * μ¦‰, μ‹¤μ λ΅ μ»΄νμΌλλ©΄ new μΈν„°νμ΄μ¤ {κµ¬ν„...} μ΄λ° μ‹μΌλ΅ λ°”λ€κ² λμ§€, μ‹¤μ  ν•¨μν• ν”„λ΅κ·Έλλ°μ λλ‹¤μ™€λ” μ•½κ°„ λ‹¤λ¦„
 * λ§μΈ μ¦‰μ¨, μ–΄λ– ν• ν•¨μν• μΈν„°νμ΄μ¤μ— κ·€μ†λμ–΄μ•Όλ§ λλ‹¤κ°€ μ΅΄μ¬ν•  μ μλ‹¤
 *
 * λ°λ©΄, μ•„κΉ μμ‹μ—μ„ λ΄¤λ“― μ½”ν‹€λ¦°μ€ κ·Έλƒ¥ νƒ€μ… μ •μλ§μΌλ΅λ„ λλ‚  μ μλ‹¤
 * λ¬Έλ²•μ μΌλ΅λ” μ¤‘κ΄„νΈμ— ν™”μ‚΄ν‘ λ¬Έλ²•μ„ μ μ–΄μ¤μΌλ΅μ¨ μ½”ν‹€λ¦°μ λλ‹¤μ‹μ΄ μ™„μ„±λλ‹¤
 */

/**
 * μ„μ λ‚΄μ©μ—μ„, ν™•μ¥ ν•¨μμ—μ„ λ΄¤λ 'λ¦¬μ‹λ²„' κ°λ…κΉμ§€ λλ‹¤μ— κ°–μ¶°μ§ μ μλ‹¤
 * StringBuilder.() -> Unit μ΄κ² κ³§ λ¦¬μ‹λ²„ νƒ€μ…μ΄κ³  μ– λ–„λ¬Έμ— itμ΄λ‹ thisλ‹ μ•μ κ³ λ„ λ°”λ΅ μ ‘κ·Ό κ°€λ¥
 */
val appendHello: StringBuilder.() -> Unit = {
    this.append("Hello")
    append(" World") // `this.` μƒλµ κ°€λ¥ -> λ¦¬μ‹λ²„ λ•λ¶„
}

/**
 * MutableList<Int> κ°€ λ¦¬μ‹λ²„κ°€ λκ³ 
 * νλΌλ―Έν„°μ™€ λ°ν™κ°’μ΄ μ—†λ” λλ‹¤μ‹μ΄ μ‘μ„±λλ‹¤
 */
val example: MutableList<Int>.() -> Unit = {
}

class Canvas {
    fun drawCircle() = println("π  Drawing a circle")
    fun drawSquare() = println("π¥ Drawing a square")
}

// λ¦¬μ‹λ²„ ν¬ν•¨ λλ‹¤ ν‘ν„μ‹ μ‘μ„±
fun render(block: Canvas.() -> Unit): Canvas {
    val canvas = Canvas()
    // block λλ‹¤ νΈμ¶
    canvas.block()
    return canvas
}

/**
 * λλ‹¤ λΈ”λ΅μ—μ„ ->λ” β€νλΌλ―Έν„° μ΄λ¦„κ³Ό λ³Έλ¬Έμ„ κ°€λ¥΄λ” κµ¬λ¶„μβ€
 * λ”°λΌμ„ νλΌλ―Έν„°κ°€ μ—†μΌλ©΄ ->λ„ μ—†λ‹¤
 * λ‹¨μΌ νλΌλ―Έν„°λ” itμΌλ΅ μ¶•μ•½ κ°€λ¥
 * λ¦¬μ‹λ²„λ” thisλ΅ μ ‘κ·Ό, ->μ™€λ” λ¬΄κ΄€
 */
fun main() {
    render {
        // λ¦¬μ‹λ²„μ λ©¤λ²„λ“¤ νΈμ¶ κ°€λ¥
        /**
         * λ¦¬μ‹λ²„ μλ” λλ‹¤ = ν™•μ¥ ν•¨μ λ¬Έλ²•κ³Ό λΉ„μ·
         * λΈ”λ΅ μ•μ—μ„ thisλ” κ³§ λ¦¬μ‹λ²„ κ°μ²΄
         * λ€λ¶€λ¶„ μƒλµ κ°€λ¥, μλ°” ν΄λμ¤μ this μƒλµκ³Ό λ™μΌν•κ² μƒκ°ν•΄λ„ λ¬΄λ°©
         * λ‹¨, μ—¬λ¬ λ¦¬μ‹λ²„κ°€ κ²ΉμΉλ” μƒν™©μ—μ„λ” this@λ¦¬μ‹λ²„λ…μ„ μ¨μ„ κµ¬λ¶„
         */
        drawCircle()
        this.drawSquare()
    }
}